<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Verification Digest &mdash; Talkable Documentation</title>
    
    <link rel="stylesheet" href="../_static/talkable.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Talkable Documentation" href="../index.html" />
    <link rel="up" title="E-Commerce Integrations" href="../ecommerce.html" />
    <link rel="next" title="Standalone Integrations" href="../standalone.html" />
    <link rel="prev" title="Verifying Integration" href="verify.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
  <link href="../_static/pygments-github.css" rel="stylesheet">
  <link href="../_static/img/favicon.ico" rel="shortcut icon" />
  </head>
  <body>
  
    <div class="header">
      <a href="../index.html" class="header-logo">Talkable docs</a>
          <form class="header-search" action="../search.html" method="get">
            <input type="text" class="textfield header-search-field" name="q" placeholder="Search docs" />
            <input type="submit" class="button header-search-button" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
      <div class="header-disclaimer">
        Visit
        <a href="https://www.talkable.com" target="_blank">www.talkable.com</a>
      </div>
    </div> <!-- /.header -->
  

  <div class="content-container content clearfix">
      <div class="nav">
        <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../ecommerce.html">E-Commerce Integrations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="custom.html">Default Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="platform.html">Platform Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="verify.html">Verifying Integration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Verification Digest</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instruction">Instruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-a-digest">Generating a digest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passing-a-digest">Passing a digest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digest-generation-algorithm">Digest generation algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../standalone.html">Standalone Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saas.html">SaaS Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../campaigns.html">Talkable Campaigns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optional.html">Optional Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_hooks.html">Web Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_v2.html">API Reference</a></li>
</ul>

      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="ecommerce-verification-digest"></span><div class="section" id="verification-digest">
<h1>Verification Digest<a class="headerlink" href="#verification-digest" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Purchases and events are passed via JavaScript to Talkable. It is possible to secure this data transmission by using Talkable&#8217;s Verification Digest. The Verification Digest acts as a checksum which will ensure that any event or purchase that’s being registered is coming from the authorized source only. This process includes hashing a <strong>salt</strong> <a class="reference external" href="http://en.wikipedia.org/wiki/Salt_(cryptography">http://en.wikipedia.org/wiki/Salt_(cryptography</a>) with the ordinary purchase data that’s being passed over. The salt will be a random string that is shared between the two parties and is kept private. Talkable provides a method that will allow you to encrypt your (salt + purchase data) combo via SHA-256 which will output the encrypted Verification Digest string which can then be passed freely over JavaScript which Talkable will use to authorize requests. Only when Talkable is able to successfully decrypt the verification digest with the shared salt will the data be registered.</p>
<div class="line-block">
<div class="line">Documentation: <a class="reference external" href="http://docs.talkable.com/ecommerce/verification_digest.html">http://docs.talkable.com/ecommerce/verification_digest.html</a></div>
<div class="line">Java Source: <a class="reference external" href="https://gist.github.com/bogdan/811591b1c7f36f3a28fb">https://gist.github.com/bogdan/811591b1c7f36f3a28fb</a></div>
</div>
</div>
<div class="section" id="instruction">
<h2>Instruction<a class="headerlink" href="#instruction" title="Permalink to this headline">¶</a></h2>
<p>In order to take advantage of the verification digest, you will need to import the Java source above, or copy &amp; make use of the public methods included.  The example Java Source above also contains an example on how to create the verification digest. As demonstrated below, you will call the verification_digest method and provide the salt + purchase order details. The returned digest can now be safely passed via JS to the verification_digest parameter which is passed as part of the order details object [as seen in <a class="reference internal" href="#passing-a-digest">Passing a digest</a>].</p>
</div>
<div class="section" id="generating-a-digest">
<h2>Generating a digest<a class="headerlink" href="#generating-a-digest" title="Permalink to this headline">¶</a></h2>
<p>In the example code below we are simply calling the verification_digest method which takes parameters {salt/key, event type, order #, email, amount, coupons} and returns the hashed checksum which is used as the verification digest.</p>
<div class="highlight-java"><div class="highlight"><pre>public static void main(String []args)
throws UnsupportedEncodingException, NoSuchAlgorithmException {
  String[] codes = { &quot;ONE&quot;, &quot;TWO&quot; };
  String digest = verification_digest(&quot;ef591fbbc527d77402d9a10dba92c195&quot;, &quot;purchase&quot;,
      &quot;100011&quot;, ”customer@example.com&quot;, &quot;200.00&quot;, &quot;2014-01-01T00:00:00+00:00&quot;, codes);
}
</pre></div>
</div>
</div>
<div class="section" id="passing-a-digest">
<h2>Passing a digest<a class="headerlink" href="#passing-a-digest" title="Permalink to this headline">¶</a></h2>
<p>In the example code below we are passing Verification Digest string to Talkable in verification_digest parameter.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">_curebit_order_details</span> <span class="o">=</span> <span class="p">{</span>
   <span class="nx">order_number</span><span class="o">:</span> <span class="s1">&#39;100011&#39;</span><span class="p">,</span> <span class="c1">// REQUIRED - Order number</span>
   <span class="nx">order_date</span><span class="o">:</span> <span class="s1">&#39;2014-04-15T08:18:44+00:00&#39;</span><span class="p">,</span> <span class="c1">// REQUIRED - Order Date and Time (ISO 8601 formatted datetime)</span>
   <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;customer@example.com&#39;</span><span class="p">,</span> <span class="c1">// REQUIRED - Customer Email Address</span>
   <span class="nx">subtotal</span><span class="o">:</span> <span class="s1">&#39;23.97&#39;</span><span class="p">,</span> <span class="c1">// REQUIRED - Purchase Subtotal</span>
   <span class="nx">coupon_code</span><span class="o">:</span> <span class="s1">&#39;SAVE20&#39;</span><span class="p">,</span> <span class="c1">// REQUIRED - Coupon code used at checkout, multiple coupons allowed as JS array: [&#39;SAVE20&#39;, &#39;FREE-SHIPPING&#39;]. Pass null if there is no coupon code.</span>
   <span class="p">...</span>
   <span class="nx">verification_digest</span><span class="o">:</span> <span class="s1">&#39;60a511b9d8d45fe2ea8568e21138f517761be05ffda693135c68c2ec551ee507&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="digest-generation-algorithm">
<h2>Digest generation algorithm<a class="headerlink" href="#digest-generation-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Control sum generation algorithm needs to be kept in secret from potential attacker.
That is why verifiction_digest should be generated only in backend.</p>
<p>In order to generate it, merchant needs to form a request verification string with request parameters and a &#8220;salt&#8221; and encode it with SHA-256 algorithm.
Salt is a secret key that can be obtained in site setting after enabling &#8220;Verification Digest&#8221; feature.
Example salt looks like:</p>
<p>3c34e72917aba5885f75f8ae300d195e</p>
<p>Here is example:
Suppose we have a purchase creation request with the following parameters:</p>
<ul class="simple">
<li>event_category: &#8216;purchase&#8217;</li>
<li>order_number: &#8216;100011&#8217;</li>
<li>email: <a class="reference external" href="mailto:example&#37;&#52;&#48;customer&#46;com">example<span>&#64;</span>customer<span>&#46;</span>com</a></li>
<li>subtotal: 83.32</li>
<li>order_date: 2014-01-01T15:30:24+00:00</li>
<li>coupon_code: EFF-32 and FREE-SHIPPING (2 code for single purchase)</li>
</ul>
<p>In this case:</p>
<ul class="simple">
<li>Verification String: <cite>3c34e72917aba5885f75f8ae300d195e|100011|purchase|example&#64;customer.com|83.32|2014-01-01T15:30:24+00:00|EFF-32,FREE-SHIPPING</cite></li>
<li>Verfication Digest:  <cite>23872240ee24867de082ce26c3baef821100e89be43d4d359f5c52fb4bad75b6</cite></li>
</ul>
<p>If some of the parameters above is blank, than it should not be included in request verification string:</p>
<p>For example: if order_date is null, the request verification string looks like:</p>
<ul class="simple">
<li>Verification String: <cite>3c34e72917aba5885f75f8ae300d195e|100011|purchase|example&#64;customer.com|83.32|EFF-32,FREE-SHIPPING</cite></li>
<li>Verfication Digest:  <cite>a5dc18fcb8f53f20d935b1cd1e83b9967d51fc6297cfe1d90af4f6d78a7a484b</cite></li>
</ul>
<p>If there is no coupons associated with a purchase, the request verification string looks like:</p>
<ul class="simple">
<li>Verification String: <cite>3c34e72917aba5885f75f8ae300d195e|100011|purchase|example&#64;customer.com|83.32|2014-01-01T15:30:24+00:00</cite></li>
<li>Verfication Digest:  <cite>9fb8c6ecfa1eb82a4ea91fe67cd1866ffda6271d956ddf2ce22b48b47fdaf53c</cite></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div> <!-- /.content-container -->
  </body>
</html>