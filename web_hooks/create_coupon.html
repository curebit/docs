<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Create Coupon Web Hook &mdash; Talkable Documentation</title>
    
    <link rel="stylesheet" href="../_static/talkable.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Talkable Documentation" href="../index.html" />
    <link rel="up" title="Web Hooks" href="../web_hooks.html" />
    <link rel="next" title="Referral Web Hook" href="referral.html" />
    <link rel="prev" title="Web Hooks" href="../web_hooks.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
  <link href="../_static/pygments-github.css" rel="stylesheet">
  <link href="../_static/img/favicon.ico" rel="shortcut icon" />
  </head>
  <body>
  
    <div class="header">
      <a href="../index.html" class="header-logo">Talkable docs</a>
          <form class="search-form" action="../search.html" method="get">
            <input type="text" class="textfield search-form-field" name="q" placeholder="Search docs" />
            <input type="submit" class="button search-form-button" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
      <div class="header-disclaimer">
        Visit
        <a href="https://www.talkable.com" target="_blank">www.talkable.com</a>
      </div>
    </div> <!-- /.header -->
  

  <div class="content-container content clearfix">
      <div class="nav">
        <ul>
<li class="toctree-l1"><a class="reference internal" href="../campaigns.html">Talkable Campaigns</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features.html">Advanced Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../integration/custom_integration.html">Standard Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../integration/shopify.html">Shopify Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../integration/magento.html">Magento Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../integration/demandware.html">Demandware Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_v2.html">API Reference</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../web_hooks.html">Web Hooks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Create Coupons</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="referral.html">Referral</a></li>
<li class="toctree-l2"><a class="reference internal" href="reward.html">Reward</a></li>
<li class="toctree-l2"><a class="reference internal" href="post_share.html">Post Share</a></li>
<li class="toctree-l2"><a class="reference internal" href="offer_signup.html">Advocate Signup</a></li>
<li class="toctree-l2"><a class="reference internal" href="claim_signup.html">Friend Email Gating</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ios_sdk.html">Talkable iOS SDK</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../android_sdk.html">Talkable Android SDK</a></li>
</ul>

      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="web-hooks-create-coupon"></span><div class="section" id="create-coupon-web-hook">
<h1>Create Coupon Web Hook<a class="headerlink" href="#create-coupon-web-hook" title="Permalink to this headline">¶</a></h1>
<p>Used for enterprise clients who want to give unique coupons to each visitor
and don’t want to manually upload a list of coupon codes to Talkable. In order
to create coupon codes for a coupon list automatically, Talkable can notify
a customer site which coupons should be created.</p>
<h2>When does Talkable call this web hook?</h2><p>Suppose we have some codes in coupon list that are available for use. When the
number of coupons available drops below Threshold, the system tries to generate
15 new coupons in the background. If some person needs a coupon code, but there
are no coupon codes available, the system will try to generate one in the
foreground and give it to the person that requested it. In both cases coupons
are sent as a web hook and then inserted into the Talkable database only in case
when a web hook returns a successful response.</p>
<p>Threshold is dynamically calculated based on number of coupon codes used by
site in last 21 days. In this way Talkable coupon lists will always hold enough
available coupons to serve the site for 21 days if integration become broken.
Minimum Threshold is 20 coupons.</p>
<h2>Coupon Expiration timestamp</h2><p>Talkable having a hard time making decision when the coupon we are creating should expire.
Only coupons that should be given on Friend Claim Page can have expiration and only when campaign offers are setup to expire.
Other coupons given as &#8220;Reward For Sharing&#8221; or &#8220;Advocate Reward for Referral&#8221; should not have expiration.</p>
<p>Expiration date for coupon on Friend Claim page is always greater than Advocate Claim Page expiration date + one day buffer.
So Talkable is making web hooks with expiration set to Friend Claim page expiration + 1 day when it has no coupons that match this criteria in its own database.</p>
<h2>Payload parameters provided for Create Coupon Web Hook</h2><ul class="simple">
<li><strong>coupon_code</strong> — coupon code</li>
<li><strong>discount_amount</strong> — discount amount</li>
<li><strong>percentage_discount</strong> — when true percentage discount should be created otherwise fixed discount</li>
<li><strong>expires_at</strong> — coupon expiration date</li>
<li><strong>usage_limit</strong> — number of usages for the coupon</li>
<li><strong>coupon_list_id</strong> — ID of the coupon list that need to be filled</li>
<li><strong>coupon_list_name</strong> — Name of the coupon list that need to be filled</li>
</ul>
<h2>Sample payload</h2><div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;coupon_code&quot;</span><span class="o">:</span> <span class="s2">&quot;WHT58574&quot;</span><span class="p">,</span>
  <span class="s2">&quot;discount_amount&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s2">&quot;percentage_discount&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="s2">&quot;usage_limit&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;expires_at&quot;</span><span class="o">:</span> <span class="s2">&quot;2014-04-14T06:17:14.309-07:00&quot;</span><span class="p">,</span>
  <span class="s2">&quot;coupon_list_id&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;coupon_list_name&quot;</span><span class="o">:</span> <span class="s2">&quot;$10 off&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<h2>cURL example</h2><div class="highlight-bash"><div class="highlight"><pre>curl --data <span class="s1">&#39;key=&lt;key&gt;&amp;payload={&quot;coupon_code&quot;:&quot;WHT58574&quot;,&quot;discount_amount&quot;:10,&quot;percentage_discount&quot;:false,&quot;usage_limit&quot;:1,&quot;expires_at&quot;:&quot;2014-04-14T06:17:14.309-07:00&quot;,&quot;coupon_list_id&quot;:1,&quot;coupon_list_name&quot;:&quot;$10 off&quot;}&#39;</span> &lt;url&gt;
</pre></div>
</div>
<div class="hidden docutils container">
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div> <!-- /.content-container -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-63500208-1', 'auto');
    ga('send', 'pageview');
  </script>
  </body>
</html>